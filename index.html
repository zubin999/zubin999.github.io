<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>李祖彬的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="google-site-verification" content="cnfvbLxGQVUqJA07xjs400UpudKGP4An6xmyJDBiDlM" />
  <meta name="description" content="各种常见的，非常见的PHP，JavaScript，HTML，MySQL，phalcon等问题以及解决办法">
  
  
  <meta name="author" content="李祖彬">
  
  
    <link rel="shortcut icon" href="/css/images/favicon.ico">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">李祖彬的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">lizubin.com</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/words">杂念</a>
        
      </nav>
      <nav id="sub-nav">
        
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://lizubin.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-the-differences-of-href-between-firefox-and-chrome" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/the-differences-of-href-between-firefox-and-chrome.html" class="article-date">
  <time class="dt-published" datetime="2024-12-10T03:12:36.000Z" itemprop="datePublished">2024-12-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/the-differences-of-href-between-firefox-and-chrome.html">href=&#39;javascript:&#39;在firefox与chrome中的不同表现</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在前端开发中，我们经常会使用<code>&lt;a&gt;</code>标签来实现页面跳转，而<code>href</code>属性是<code>&lt;a&gt;</code>标签中最重要的属性之一。<code>href</code>除了可以指定跳转的链接外，还可以指定一些特殊值，比如<code>href=&quot;javascript:&quot;</code>。这样能执行一段js代码，比如<code>alert(&#39;hello&#39;)</code>。现在就遇到了一个问题，在chrome中，<code>href=&quot;javascript:&quot;</code>可以执行js代码，但是在firefox中虽然也执行了，但是结果却不是我们想要的。比如这样一段代码：</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;a href&#x3D;&quot;javascript:layer.msg(&#39;请下载APP&#39;)&quot;&gt;我要报名&lt;&#x2F;a&gt;</code></pre>

<p>在firefox中执行结果：</p>
<p><img src="/the-differences-of-href-between-firefox-and-chrome/0.gif" alt="firefox中的结果"></p>
<p>在chrome中执行结果：</p>
<p><img src="/the-differences-of-href-between-firefox-and-chrome/2.gif" alt="chrome中的结果"></p>
<p>firefox中执行了js代码，但是最后整个<code>HTML</code>页面内容变成了一个<code>3</code>。数字3是哪里来的呢？而chrome中执行了js代码，并且页面内容也正常显示。要解决这个问题，最简单的办法就是使用<code>onclick</code>属性，而不是<code>href</code>属性。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;a href&#x3D;&quot;#&quot; onclick&#x3D;&quot;layer.msg(&#39;请下载APP&#39;);return false;&quot;&gt;我要报名&lt;&#x2F;a&gt;</code></pre>

<p>在firefox中执行结果：</p>
<p><img src="/the-differences-of-href-between-firefox-and-chrome/1.gif" alt="firefox中的结果"></p>
<p>经过测试发现，在<code>firefox</code>中，<code>href=&quot;javascript:&quot;</code>后面的代码如果有返回值，不论这个值是布尔值，数字，或者字符串，那么firefox就会把整个<code>HTML</code>页面内容变成返回值。</p>
<p><img src="/the-differences-of-href-between-firefox-and-chrome/4.gif" alt="firefox中的结果"></p>
<p>而在<code>chrome</code>中，<code>href=&quot;javascript:&quot;</code>后面的代码如果有返回值，如果是数字，布尔值，那么<code>chrome</code>会忽略返回值，如果是字符串，那么<code>chrome</code>也会把字符串显示在页面中。</p>
<p>在<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/URI/Schemes/javascript">MDN</a>有这么一段话：</p>
<blockquote>
<p>JavaScript URLs, URLs prefixed with the javascript: scheme, are used as fake navigation targets that execute JavaScript when the browser attempts to navigate. If the URL evaluates to a string, it is treated as HTML and rendered by the browser.</p>
</blockquote>
<p>最后一句说了，如果URL解析后是一个字符串，那么浏览器会把它当作HTML来渲染。但明显firefox执行了更严格的规则，所有的返回值都会被当作HTML来渲染。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/the-differences-of-href-between-firefox-and-chrome.html" data-id="cm82dxb18007g0cpj53kxhqng" data-title="href=&#39;javascript:&#39;在firefox与chrome中的不同表现" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/href/" rel="tag">href</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-use-multi-stage-to-reduce-size-of-docker-images" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/use-multi-stage-to-reduce-size-of-docker-images.html" class="article-date">
  <time class="dt-published" datetime="2024-03-18T10:10:25.000Z" itemprop="datePublished">2024-03-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/use-multi-stage-to-reduce-size-of-docker-images.html">用Multi-stage builds给你的docker镜像瘦身</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>为什么别人的docker镜像很小？为什么我们的docker镜像很大？因为我们的Dockerfile编写姿势不对。比如这样一个Dockerfile:</p>
<pre class="line-numbers language-Dockerfile" data-language="Dockerfile"><code class="language-Dockerfile">FROM centos:7

#init
WORKDIR &#x2F;home
RUN mkdir ffmpeg_sources ffmpeg_build
RUN yum -y update &amp;&amp; yum install -y \
  autoconf \
  automake \
  bzip2 \
  bzip2-devel \
  cmake \
  freetype-devel \
  gcc \
  gcc-c++ \
  git \
  libtool \
  make \
  pkgconfig \
  zlib-devel \
  openssl \
  openssl-devel \
  python3

#ffmpeg extensions
#NASM
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
RUN curl -O -L https:&#x2F;&#x2F;www.nasm.us&#x2F;pub&#x2F;nasm&#x2F;releasebuilds&#x2F;2.15.05&#x2F;nasm-2.15.05.tar.bz2 &amp;&amp; tar xjvf nasm-2.15.05.tar.bz2
WORKDIR nasm-2.15.05
RUN .&#x2F;autogen.sh &amp;&amp; .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; &amp;&amp; make &amp;&amp; make install

#Yasm
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY .&#x2F;lib&#x2F;yasm-1.3.0.tar.gz .
RUN tar xzvf yasm-1.3.0.tar.gz
WORKDIR yasm-1.3.0
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot;
RUN make &amp;&amp; make install

#libx264
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY .&#x2F;lib&#x2F;x264 .&#x2F;x264
WORKDIR x264
ENV PKG_CONFIG_PATH&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&#x2F;lib&#x2F;pkgconfig&quot;
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; --enable-static
RUN make &amp;&amp; make install

#libx265
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;x265_git .&#x2F;x265_git
RUN cd .&#x2F;x265_git&#x2F;build&#x2F;linux &amp;&amp; cmake -G &quot;Unix Makefiles&quot; -DCMAKE_INSTALL_PREFIX&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; -DENABLE_SHARED:bool&#x3D;off ..&#x2F;..&#x2F;source &amp;&amp; make &amp;&amp; make install

#libfdk_aac
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;fdk-aac .&#x2F;fdk-aac
WORKDIR fdk-aac
RUN autoreconf -fiv
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot;
RUN make &amp;&amp; make install

#libmp3lame
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;lame-3.100.tar.gz .&#x2F;
RUN tar xzvf lame-3.100.tar.gz
WORKDIR lame-3.100
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; --enable-nasm
RUN make &amp;&amp; make install

#libopus
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;opus-1.3.1.tar.gz .&#x2F;opus-1.3.1.tar.gz
RUN tar xzvf opus-1.3.1.tar.gz
WORKDIR opus-1.3.1
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot;  --disable-shared
RUN make &amp;&amp; make install

#libvpx
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;libvpx .&#x2F;libvpx
WORKDIR libvpx
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --disable-examples --disable-unit-tests --enable-vp9-highbitdepth --as&#x3D;yasm
RUN make &amp;&amp; make install

#ffmpeg
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;ffmpeg-snapshot.tar.bz2 .
RUN tar xjvf ffmpeg-snapshot.tar.bz2
WORKDIR ffmpeg
ENV PATH&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin:$PATH&quot; PKG_CONFIG_PATH&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&#x2F;lib&#x2F;pkgconfig&quot;
RUN .&#x2F;configure \
  --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; \
  --pkg-config-flags&#x3D;&quot;--static&quot; \
  --extra-cflags&#x3D;&quot;-I&#x2F;home&#x2F;ffmpeg_build&#x2F;include&quot; \
  --extra-ldflags&#x3D;&quot;-L&#x2F;home&#x2F;ffmpeg_build&#x2F;lib&quot; \
  --extra-libs&#x3D;-lpthread \
  --extra-libs&#x3D;-lm \
  --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; \
  --enable-gpl \
  --enable-libfdk_aac \
  --enable-libfreetype \
  --enable-libmp3lame \
  --enable-libopus \
  --enable-libvpx \
  --enable-libx264 \
  --enable-libx265 \
  --enable-nonfree \
  --enable-openssl
RUN make &amp;&amp; make install

#clean
WORKDIR &#x2F;home
RUN rm -rf &#x2F;home&#x2F;*

RUN pip3 install supervisor

COPY supervisord.conf &#x2F;etc&#x2F;

WORKDIR &#x2F;home
CMD [&quot;&#x2F;bin&#x2F;bash&quot;]</code></pre>

<p>虽然，最后做了清理工作，删除了home目录里的所有不需要的内容，但是最后编译的镜像依然很大</p>
<p><img src="/use-multi-stage-to-reduce-size-of-docker-images/v1.png" alt="v1"></p>
<p>但我们如果把它分开：</p>
<pre class="line-numbers language-none"><code class="language-none">FROM centos:7

#init
WORKDIR &#x2F;home
RUN mkdir ffmpeg_sources ffmpeg_build
RUN yum -y update &amp;&amp; yum install -y \
  autoconf \
  automake \
  bzip2 \
  bzip2-devel \
  cmake \
  freetype-devel \
  gcc \
  gcc-c++ \
  git \
  libtool \
  make \
  pkgconfig \
  zlib-devel \
  openssl \
  openssl-devel

#ffmpeg extensions
#NASM
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
RUN curl -O -L https:&#x2F;&#x2F;www.nasm.us&#x2F;pub&#x2F;nasm&#x2F;releasebuilds&#x2F;2.15.05&#x2F;nasm-2.15.05.tar.bz2 &amp;&amp; tar xjvf nasm-2.15.05.tar.bz2
WORKDIR nasm-2.15.05
RUN .&#x2F;autogen.sh &amp;&amp; .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; &amp;&amp; make &amp;&amp; make install

#Yasm
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY .&#x2F;lib&#x2F;yasm-1.3.0.tar.gz .
RUN tar xzvf yasm-1.3.0.tar.gz
WORKDIR yasm-1.3.0
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot;
RUN make &amp;&amp; make install

#libx264
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY .&#x2F;lib&#x2F;x264 .&#x2F;x264
WORKDIR x264
ENV PKG_CONFIG_PATH&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&#x2F;lib&#x2F;pkgconfig&quot;
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; --enable-static
RUN make &amp;&amp; make install

#libx265
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;x265_git .&#x2F;x265_git
RUN cd .&#x2F;x265_git&#x2F;build&#x2F;linux &amp;&amp; cmake -G &quot;Unix Makefiles&quot; -DCMAKE_INSTALL_PREFIX&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; -DENABLE_SHARED:bool&#x3D;off ..&#x2F;..&#x2F;source &amp;&amp; make &amp;&amp; make install

#libfdk_aac
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;fdk-aac .&#x2F;fdk-aac
WORKDIR fdk-aac
RUN autoreconf -fiv
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot;
RUN make &amp;&amp; make install

#libmp3lame
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;lame-3.100.tar.gz .&#x2F;
RUN tar xzvf lame-3.100.tar.gz
WORKDIR lame-3.100
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; --enable-nasm
RUN make &amp;&amp; make install

#libopus
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;opus-1.3.1.tar.gz .&#x2F;opus-1.3.1.tar.gz
RUN tar xzvf opus-1.3.1.tar.gz
WORKDIR opus-1.3.1
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot;  --disable-shared
RUN make &amp;&amp; make install

#libvpx
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;libvpx .&#x2F;libvpx
WORKDIR libvpx
RUN .&#x2F;configure --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; --disable-examples --disable-unit-tests --enable-vp9-highbitdepth --as&#x3D;yasm
RUN make &amp;&amp; make install

#ffmpeg
WORKDIR &#x2F;home&#x2F;ffmpeg_sources
COPY lib&#x2F;ffmpeg-snapshot.tar.bz2 .
RUN tar xjvf ffmpeg-snapshot.tar.bz2
WORKDIR ffmpeg
ENV PATH&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin:$PATH&quot; PKG_CONFIG_PATH&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&#x2F;lib&#x2F;pkgconfig&quot;
RUN .&#x2F;configure \
  --prefix&#x3D;&quot;&#x2F;home&#x2F;ffmpeg_build&quot; \
  --pkg-config-flags&#x3D;&quot;--static&quot; \
  --extra-cflags&#x3D;&quot;-I&#x2F;home&#x2F;ffmpeg_build&#x2F;include&quot; \
  --extra-ldflags&#x3D;&quot;-L&#x2F;home&#x2F;ffmpeg_build&#x2F;lib&quot; \
  --extra-libs&#x3D;-lpthread \
  --extra-libs&#x3D;-lm \
  --bindir&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;bin&quot; \
  --enable-gpl \
  --enable-libfdk_aac \
  --enable-libfreetype \
  --enable-libmp3lame \
  --enable-libopus \
  --enable-libvpx \
  --enable-libx264 \
  --enable-libx265 \
  --enable-nonfree \
  --enable-openssl
RUN make &amp;&amp; make install

FROM centos:7

RUN yum update -y &amp;&amp; yum install -y python3
RUN pip3 install supervisor

COPY supervisord.conf &#x2F;etc&#x2F;
COPY --from&#x3D;0 &#x2F;usr&#x2F;local&#x2F;bin&#x2F;ffmpeg &#x2F;usr&#x2F;local&#x2F;bin

CMD [&quot;&#x2F;bin&#x2F;bash&quot;]</code></pre>

<p>这样得到的镜像大大缩小了：</p>
<p><img src="/use-multi-stage-to-reduce-size-of-docker-images/v2.png" alt="v2"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/use-multi-stage-to-reduce-size-of-docker-images.html" data-id="cm82dxb19007i0cpjhw89gg99" data-title="用Multi-stage builds给你的docker镜像瘦身" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multi-stage/" rel="tag">multi-stage</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ffmpeg-installation-guide" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/ffmpeg-installation-guide.html" class="article-date">
  <time class="dt-published" datetime="2024-01-23T02:22:32.000Z" itemprop="datePublished">2024-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/ffmpeg-installation-guide.html">ffmpeg安装记录</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><code>ffmpeg</code>简介</li>
</ul>
<blockquote>
<p>FFmpeg is the leading multimedia framework, able to decode, encode, transcode, mux, demux, stream, filter and play pretty much anything that humans and machines have created. It supports the most obscure ancient formats up to the cutting edge. No matter if they were designed by some standards committee, the community or a corporation. It is also highly portable: FFmpeg compiles, runs, and passes our testing infrastructure FATE across Linux, Mac OS X, Microsoft Windows, the BSDs, Solaris, etc. under a wide variety of build environments, machine architectures, and configurations.</p>
</blockquote>
<p>FFmpeg是领先的多媒体框架，能够解码、编码、转码、复用、解复用、流式传输、过滤和播放几乎人类和机器所创建的任何内容。它支持从最古老的晦涩格式到最前沿的格式。无论这些格式是由标准委员会、社区还是公司设计的。它还具有高度可移植性：FFmpeg可以在Linux、Mac OS X、Microsoft Windows、BSDs、Solaris等各种构建环境、机器架构和配置下编译运行，并通过我们的测试基础设施FATE。</p>
<ul>
<li>下载及安装</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">git clone https:&#x2F;&#x2F;git.ffmpeg.org&#x2F;ffmpeg.git ffmpeg
cd ffmpeg

.&#x2F;configure \
 --enable-gpl \
 --enable-version3 \
 --enable-nonfree \
 --enable-shared \
 --enable-libfdk-aac \
 --enable-libfreetype \
 --enable-libmp3lame \
 --enable-libqrencode \
 --enable-libwebp \
 --enable-libx264 \
 --enable-libx265 \
 --enable-openssl
 make
 make install</code></pre>

<p>在安装过程中可能会遇到一些错误，以下是一些常见错误及其解决方法：</p>
<ol>
<li><p>如果出现错误：<code>nasm/yasm not found or too old. Use --disable-x86asm for a crippled build.</code>，可以使用<code>yum</code>安装<code>yasm</code>: <code>yum install yasm</code></p>
</li>
<li><p>如果出现错误：<code>ERROR: libfdk_aac not found</code>，可以使用以下命令解决：</p>
</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">git clone --depth 1 https:&#x2F;&#x2F;github.com&#x2F;mstorsjo&#x2F;fdk-aac
cd fdk-aac
&#x2F;&#x2F;里面有个autogen.sh,也可以直接运行.&#x2F;autogen.sh
autoreconf -fiv
.&#x2F;configure --prefix&#x3D;&quot;$HOME&#x2F;ffmpeg_build&quot; --disable-shared
make
make install</code></pre>

<ol start="3">
<li><p>如果出现错误：<code>ERROR: freetype2 not found using pkg-config</code>，可以使用<code>yum</code>安装<code>freetype-devel</code>: <code>yum install freetype-devel</code></p>
</li>
<li><p>如果出现错误：<code>ERROR: libmp3lame &gt;= 3.98.3 not found</code>，可以从<code>https://sourceforge.net/projects/lame/files/latest/download</code>下载并解压，进入目录运行命令：</p>
</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;configure
make
make install</code></pre>

<ol start="5">
<li>如果出现错误：<code>ERROR: libqrencode not found using pkg-config</code>，可以从<code>libqrencode</code>最新release下载地址：<code>https://fukuchi.org/works/qrencode/</code>。下载后解压安装：</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">tar xzf qrencode-4.1.1.tar.gz
cd qrencode-4.1.1&#x2F;
.&#x2F;configure
make
make install</code></pre>

<ol start="6">
<li>如果出现错误：<code>ERROR: libwebp &gt;= 0.2.0 not found using pkg-config</code>，可以运行命令：</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">yum install -y libwebp libwebp-devel</code></pre>

<ol start="7">
<li>如果出现错误：<code>ERROR: x264 not found using pkg-config</code>，可以运行以下命令解决：</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">git clone --branch stable --depth 1 https:&#x2F;&#x2F;code.videolan.org&#x2F;videolan&#x2F;x264.git
cd x264
.&#x2F;configure --enable-shared --enable-static
make
make install</code></pre>

<p>7.1 运行上面命令后，出现问题，需要<code>nasm</code></p>
<blockquote>
<p>Found no assembler<br>Minimum version is nasm-2.13<br>If you really want to compile without asm, configure with –disable-asm.</p>
</blockquote>
<p>运行命令：</p>
<pre class="line-numbers language-none"><code class="language-none">yum install nasm</code></pre>

<p><code>nasm</code>安装完后继续安装<code>x264</code></p>
<ol start="8">
<li>如果出现错误：<code>ERROR: x265 not found using pkg-config</code>，可以从<code>x265</code> release版本下载地址：<code>http://ftp.videolan.org/pub/videolan/x265</code>下载最新版本<code>x265</code>安装。</li>
</ol>
  <pre class="line-numbers language-none"><code class="language-none">wget http:&#x2F;&#x2F;ftp.videolan.org&#x2F;pub&#x2F;videolan&#x2F;x265&#x2F;x265_3.2.tar.gz
tar xzf x265_3.2.tar.gz
cd x265_3.2&#x2F;build&#x2F;linux
.&#x2F;make-Makefiles.bash
make
make install</code></pre>

<ol start="9">
<li>如果出现错误：<code>ERROR: openssl not found</code>，可以运行命令：</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">yum install openssl openssl-devel</code></pre>

<ol start="10">
<li>所有问题解决安装完成后运行<code>ffmpeg</code>或<code>ffmpeg -version</code>出现错误：<code>ffmpeg: error while loading shared libraries: libavdevice.so.60: cannot open shared object file: No such file or directory</code></li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">export LD_LIBRARY_PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;lib:&#x2F;usr&#x2F;local&#x2F;lib64&#x2F;:&#x2F;usr&#x2F;local&#x2F;lib&#x2F;x86_64-linux-gnu:$LD_LIBRARY_PATH</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/ffmpeg-installation-guide.html" data-id="cm82dxb05001m0cpjdz0oaa6m" data-title="ffmpeg安装记录" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ffmpeg/" rel="tag">ffmpeg</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/guide/" rel="tag">guide</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/installation/" rel="tag">installation</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-how-to-generate-excel-s-cell-by-php-s-closure" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/how-to-generate-excel-s-cell-by-php-s-closure.html" class="article-date">
  <time class="dt-published" datetime="2023-11-09T02:03:40.000Z" itemprop="datePublished">2023-11-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/how-to-generate-excel-s-cell-by-php-s-closure.html">如何使用PHP闭包生成Excel单元格坐标</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在处理 Excel 数据时，有时需要根据行号和列号生成对应的单元格坐标。为了实现这一功能，我们可以使用 PHP 闭包来轻松地生成 Excel 单元格坐标。本文将介绍如何使用 PHP 闭包生成 Excel 单元格坐标，以及如何在实际开发中应用这一技巧。</p>
<p><strong>背景知识</strong></p>
<p>在 Excel 中，单元格坐标由列字母和行数字组成，例如 A1、B2 等。在 PHP 中，我们可以使用字符串拼接来构建这样的坐标。然而，在实际开发中，如果我们需要根据行号和列号动态生成坐标，这种方法会变得繁琐且容易出错。例如，当我们需要将一批学生数据导出到 Excel 时，我们可能需要根据行号和列号生成单元格坐标。</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$active-&gt;setCellValueExplicit(&#39;A1&#39;, &#39;姓名&#39;, DataType::TYPE_STRING2);
$active-&gt;setCellValueExplicit(&#39;B1&#39;, &#39;年龄&#39;, DataType::TYPE_STRING2);
$active-&gt;setCellValueExplicit(&#39;C1&#39;, &#39;性别&#39;, DataType::TYPE_STRING2);
$active-&gt;setCellValueExplicit(&#39;D1&#39;, &#39;学校&#39;, DataType::TYPE_STRING2);

$row &#x3D; 2;
foreach($data as $item) &#123;
    $active-&gt;setCellValueExplicit(&#39;A&#39; . $row, $item[&#39;name&#39;], DataType::TYPE_STRING2);
    $active-&gt;setCellValueExplicit(&#39;B&#39; . $row, $item[&#39;age&#39;], DataType::TYPE_STRING2);
    $active-&gt;setCellValueExplicit(&#39;C&#39; . $row, $item[&#39;gender&#39;], DataType::TYPE_STRING2);
    $active-&gt;setCellValueExplicit(&#39;D&#39; . $row, $item[&#39;school&#39;], DataType::TYPE_STRING2);
    $row++;
&#125;</code></pre>

<p>我们这样写好了，但第二天需求又变了，我们需要在姓名后加一个生日，第三天，产品说需要在学校前面加一个班级。每次我们都需要自己去改 A、B、C、D。</p>
<p><strong>解决方案</strong></p>
<p>使用 PHP 闭包可以解决这个问题。闭包是一种能够捕获外部变量并在其内部使用的函数。我们可以创建一个闭包函数，该函数接受行号和列号作为参数，并根据这些参数生成相应的单元格坐标。</p>
<p><strong>示例代码</strong></p>
<p>以下是一个使用 PHP 闭包生成 Excel 单元格坐标的示例：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">function generateCellCoordinateClosure() &#123;
    $alpha &#x3D; array_map(&#39;chr&#39;, range(65, 90));
    $columnIndex &#x3D; 0;
    return function($row) use($alpha, &amp;$columnIndex) &#123;
        return sprintf(&#39;%s%d&#39;, $alpha[$columnIndex++], $row);
    &#125;;
&#125;

$row &#x3D; 2;
foreach($data as $item) &#123;
    $alpha &#x3D; $generateCellCoordinateClosure();
    $active-&gt;setCellValueExplicit($alpha($row), $item[&#39;name&#39;], DataType::TYPE_STRING2);
    $active-&gt;setCellValueExplicit($alpha($row), $item[&#39;age&#39;], DataType::TYPE_STRING2);
    $active-&gt;setCellValueExplicit($alpha($row), $item[&#39;gender&#39;], DataType::TYPE_STRING2);
    $active-&gt;setCellValueExplicit($alpha($row), $item[&#39;school&#39;], DataType::TYPE_STRING2);
    $row++;
&#125;</code></pre>

<p>在这个示例中，我们定义了一个名为 <code>generateCellCoordinateClosure</code> 的函数，该函数返回一个闭包函数。这个闭包函数接受一个行号作为参数，并使用 <code>$columnIndex</code> 变量生成相应的单元格坐标。最后，我们每调用一次就生成该行下一列的单元格坐标。</p>
<p><strong>总结</strong></p>
<p>使用 PHP 闭包生成 Excel 单元格坐标是一种简单而有效的方法。通过定义一个接受列索引作为参数的函数，我们可以轻松地生成任意列的单元格坐标。这种方法不仅使代码更加简洁，而且减少了出错的可能性。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/how-to-generate-excel-s-cell-by-php-s-closure.html" data-id="cm82dxb09001q0cpj46ie539p" data-title="如何使用PHP闭包生成Excel单元格坐标" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/closure/" rel="tag">closure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%97%AD%E5%8C%85/" rel="tag">闭包</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-how-to-use-php-to-generate-a-word-file-by-html" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/how-to-use-php-to-generate-a-word-file-by-html.html" class="article-date">
  <time class="dt-published" datetime="2023-10-26T02:30:55.000Z" itemprop="datePublished">2023-10-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/how-to-use-php-to-generate-a-word-file-by-html.html">使用PHP根据html内容生成word文件</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>引言：</p>
<p>在现代Web开发中，富文本编辑器是一种常见的工具，它允许用户轻松地编写和格式化文本。当需要将这些富文本内容保存为Word文件时，可以使用PHP进行处理。本文将介绍两种实现此目的的方法：无需任何依赖库和使用PHPWord库。</p>
<p>方法一：无任何依赖库</p>
<p>使用纯PHP代码，无需引入任何第三方库，可以直接将富文本内容嵌入到HTML模板中，并将其保存为Word文件。代码示例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$word &#x3D; &lt;&lt;&lt;EOT
&lt;html xmlns:o&#x3D;&quot;urn:schemas-microsoft-com:office:office&quot; xmlns:w&#x3D;&quot;urn:schemas-microsoft-com:office:word&quot; xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;REC-html40&quot;&gt;
&lt;head&gt;&lt;meta charset&#x3D;&quot;UTF-8&quot; &#x2F;&gt;&lt;&#x2F;head&gt;
&lt;body&gt;
$content
&lt;&#x2F;body&gt;
&lt;&#x2F;html&gt;
EOT;

file_put_contents($file, $word);</code></pre>

<p>这种方法的优点是无需依赖任何第三方库，可以根据需要自定义排版。缺点是需要手动处理样式和布局。</p>
<p>方法二：使用PHPWord库</p>
<p>PHPWord是一个开源的PHP库，可以方便地生成多种文件格式，包括Word、HTML、PDF、RTF和ODT。使用Composer进行安装，然后利用库中提供的功能轻松地将富文本内容转换为Word文件。代码示例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">use PhpOffice\PhpWord\Element\Section;
use PhpOffice\PhpWord\IOFactory;
use PhpOffice\PhpWord\PhpWord;
use PhpOffice\PhpWord\Shared\Html;

$word &#x3D; new PhpWord();
$section &#x3D; $word-&gt;addSection();
Html::addHtml($section, $content);
$writer &#x3D; IOFactory::createWriter($word);
$writer-&gt;save($file);</code></pre>

<p>结论：</p>
<p>本文介绍了两种使用PHP将富文本内容转换为Word文件的方法。无论是选择手动编写HTML模板，还是使用PHPWord库，都能够满足开发者的需求。在实际应用中，可以根据项目需求和个人喜好来选择合适的方法。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/how-to-use-php-to-generate-a-word-file-by-html.html" data-id="cm82dxb09001r0cpjgqwshsu5" data-title="使用PHP根据html内容生成word文件" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/html/" rel="tag">html</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/word/" rel="tag">word</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-canvas-Uncaught-DOMException-Failed-to-execute-toDataURL-on-HTMLCanvasElement" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/canvas-Uncaught-DOMException-Failed-to-execute-toDataURL-on-HTMLCanvasElement.html" class="article-date">
  <time class="dt-published" datetime="2023-08-03T08:32:24.000Z" itemprop="datePublished">2023-08-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/canvas-Uncaught-DOMException-Failed-to-execute-toDataURL-on-HTMLCanvasElement.html">canvas对视频截图报错:Uncaught DOMException: Failed to execute &#39;toDataURL&#39; on &#39;HTMLCanvasElement&#39;</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li>需求</li>
</ul>
<p>页面加载完成后，视频如果没有封面图，使用canvas对视频截图作为封面图，并且通过接口传回保存。</p>
<ul>
<li>实现</li>
</ul>
<p>canvas对视频截图，十分简单，只需几行代码。</p>
<ol>
<li>获取页面中的video</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">let video &#x3D; document.getElementById(&#39;video&#39;);</code></pre>

<ol start="2">
<li>创建canvas并设置画布长和宽</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">let canvas &#x3D; document.createElement(&#39;canvas&#39;);
canvas.width &#x3D; video.videoWidth;
canvas.height &#x3D; video.videoHeight;</code></pre>

<ol start="3">
<li>绘制</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">let ctx &#x3D; canvas.getContext(&#39;2d&#39;);
ctx.drawImage(video, 0, 0, canvas.width, canvas.height);</code></pre>

<ol start="4">
<li>获取图片数据</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">let dataURI &#x3D; canvas.toDataURL(&#39;image&#x2F;jpeg&#39;);</code></pre>

<p>这里会得到图片的base64数据。但就在这里出现了错误：</p>
<pre class="line-numbers language-none"><code class="language-none">Uncaught DOMException: Failed to execute &#39;toDataURL&#39; on &#39;HTMLCanvasElement&#39;: Tainted canvases may not be exported.</code></pre>

<p>这是因为video的资源地址与当前页面是跨域状态，只需要在video中添加属性：</p>
<pre class="line-numbers language-none"><code class="language-none">crossorigin&#x3D;&quot;anonymous&quot;</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/canvas-Uncaught-DOMException-Failed-to-execute-toDataURL-on-HTMLCanvasElement.html" data-id="cm82dxazz00190cpj8eibge96" data-title="canvas对视频截图报错:Uncaught DOMException: Failed to execute &#39;toDataURL&#39; on &#39;HTMLCanvasElement&#39;" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/" rel="tag">canvas</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/toDataURL/" rel="tag">toDataURL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%A7%86%E9%A2%91%E6%88%AA%E5%9B%BE/" rel="tag">视频截图</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-pull-to-refresh-miniprogram-s-data-list" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/pull-to-refresh-miniprogram-s-data-list.html" class="article-date">
  <time class="dt-published" datetime="2023-06-12T06:28:53.000Z" itemprop="datePublished">2023-06-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/pull-to-refresh-miniprogram-s-data-list.html">小程序页面部分下拉刷新解决方案</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>小程序要下拉刷新，有两种方式：</p>
<ol>
<li>整个页面刷新</li>
<li>局部刷新</li>
</ol>
<ul>
<li>整个页面刷新</li>
</ul>
<p>整体刷新首先需要再页面配置文件(json)中添加配置：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;enablePullDownRefresh&quot;: true</code></pre>

<p>添加配置后页面可以下拉，然后再js文件<code>onPullDownRefresh</code>中编写下拉刷新逻辑代码。<strong>注：</strong>处理完后需调用<code>wx.stopPullDownRefresh()</code>结束下拉刷新，否则真机上页面下拉后不会回到原来的位置。</p>
<ul>
<li>局部刷新</li>
</ul>
<p>对于有些页面，如下图：</p>
<p><img src="/pull-to-refresh-miniprogram-s-data-list/1.jpg" alt="局部刷新列表"></p>
<p>顶部是切换的导航条剩下的是列表，刷新的时候不需要带着导航一起下拉刷新。小程序提供了一个组件：<code>scroll-view</code>。我们只需要使用<code>scroll-view</code>将列表数据包裹起来就可以了。</p>
<p><img src="/pull-to-refresh-miniprogram-s-data-list/2.png"></p>
<ul>
<li><code>refresher-enabled=&quot;true&quot;</code>开启下拉刷新</li>
<li><code>refresher-triggered=&quot;&#123;&#123;refresherTrigger&#125;&#125;&quot;</code>控制下拉刷新显示，在数据请求结束后应将<code>refresherTrigger</code>设置为<code>false</code></li>
<li><code>bindrefresherrefresh=&quot;pullDownRefresh&quot;</code>在js文件<code>pullDownRefresh</code>函数中处理下拉刷新逻辑</li>
</ul>
<p>对于局部刷新，当页面数据较少的时候，我们会遇到一个问题：</p>
        
          <p class="article-more-link">
            <a href="/pull-to-refresh-miniprogram-s-data-list.html#more">阅读全文</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/pull-to-refresh-miniprogram-s-data-list.html" data-id="cm82dxb13006z0cpjd6oh33mr" data-title="小程序页面部分下拉刷新解决方案" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0/" rel="tag">下拉刷新</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">小程序</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-promise-in-wechat-miniprogram" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/promise-in-wechat-miniprogram.html" class="article-date">
  <time class="dt-published" datetime="2023-06-05T03:32:36.000Z" itemprop="datePublished">2023-06-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/promise-in-wechat-miniprogram.html">使用promise封装小程序网络请求</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>请求接口数据：</p>
<pre class="line-numbers language-none"><code class="language-none">module.exports &#x3D; &#123;
  request: (params &#x3D; &#123;url, data&#125;) &#x3D;&gt; &#123;
    wx.showLoading(&#123;
      title: &#39;加载中...&#39;,
      mask: true
    &#125;);

    return new Promise((resolve, reject) &#x3D;&gt; &#123;
      wx.request(&#123;
        url: BaseUrl + params.url,
        data: params.data || &#123;&#125;,
        header: &#123;
            &#39;Content-Type&#39;: &#39;application&#x2F;x-www-form-urlencoded&#39;,
            &#x2F;&#x2F; 如果有接口鉴权
            &#39;SIGN&#39;: getSign(params.data),
            &#39;APPKEY&#39;: &#39;&#39;
        &#125;,
        method: &#39;post&#39;,
        success: (resp) &#x3D;&gt; &#123;
          &#x2F;&#x2F; 根据实际业务调用resolve或者reject
        &#125;,
        fail: (err) &#x3D;&gt; &#123;
          console.log(err);
          reject(err)
        &#125;,
        complete: () &#x3D;&gt; &#123;
          wx.hideLoading();
        &#125;
      &#125;)
    &#125;)
  &#125;,
&#125;</code></pre>

<p>项目中会有很多接口，我们可以根据功能模块，再独立封装。比如登录，可以新增一个login.js:</p>
<pre class="line-numbers language-none"><code class="language-none">const &#123;request&#125; &#x3D; require(&#39;request.js&#39;);

module.exports &#x3D; &#123;
  login: () &#x3D;&gt; &#123;
    &#x2F;&#x2F; ...
  &#125;,

  logout: () &#x3D;&gt; &#123;
    &#x2F;&#x2F; ...
  &#125;
&#125;</code></pre>


<p>文件上传：</p>
<pre class="line-numbers language-none"><code class="language-none">
module.exports &#x3D; &#123;
  upload: (&#123;count &#x3D; 9, mediaType &#x3D; [&#39;image&#39;, &#39;video&#39;], sizeType &#x3D; [&#39;original&#39;, &#39;compressed&#39;]&#125; &#x3D; &#123;&#125;) &#x3D;&gt; &#123;
    return new Promise((topResolve, topReject) &#x3D;&gt; &#123;
      wx.chooseMedia(&#123;
        count: count,
        mediaType: mediaType,
        sizeType: sizeType,
        success(res) &#123;
          const &#123;tempFiles&#125; &#x3D; res
          const all &#x3D; [];
          for(let i in tempFiles) &#123;
            all.push(new Promise((resolve, reject) &#x3D;&gt; &#123;
                var upTask &#x3D; wx.uploadFile(&#123;
                  url: BaseUrl + &#39;upload api&#39;
                  filePath: tempFiles[i].tempFilePath,
                  name: &#39;&#39;,
                  formData: &#123;&#125;,
                  success: (result) &#x3D;&gt; &#123;
                    resolve(JSON.parse(result.data));
                  &#125;,
                  fail: (err) &#x3D;&gt; &#123;
                    reject(err);
                  &#125;
                &#125;);
              &#125;)
            )
          &#125;
          
          Promise.all(all).then(results &#x3D;&gt; &#123;
            topResolve(results);
          &#125;).catch(err &#x3D;&gt; &#123;
            console.log(err);
            topReject(err)
          &#125;)
        &#125;
      &#125;)
    &#125;)
  &#125;
&#125;</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/promise-in-wechat-miniprogram.html" data-id="cm82dxb1500730cpj5cnl2rrp" data-title="使用promise封装小程序网络请求" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/promise/" rel="tag">promise</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">小程序</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" rel="tag">网络请求</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-the-communications-of-pages" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/the-communications-of-pages.html" class="article-date">
  <time class="dt-published" datetime="2023-05-29T06:19:52.000Z" itemprop="datePublished">2023-05-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/the-communications-of-pages.html">小程序页面间事件通信</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>小程序从版本<strong>2.7.3</strong>开始支持页面间通信事件。页面之间可以通过传递参数，本地缓存等方法实现数据通信，为什么还要事件通信呢？试想一下这么一个场景，从A页面跳转到了B页面：</p>
<pre class="line-numbers language-none"><code class="language-none">wx.navigateTo(&#123;
    url: &#39;&#x2F;pages&#x2F;B&#x2F;B&#39;
&#125;)</code></pre>

<p>在B页面做了某项操作后返回A页面，因为B页面的操作，数据已经有了新的变化，但是，我们通过<code>wx.navigateBack(&#123;delta:1&#125;)</code>返回上一级，并不会刷新页面数据。</p>
<p>如果没有事件通信，那么我们只能在返回上一级之前，在本地缓存设置一个变量并赋予一个值，然后再A页面<code>onShow</code>里面判断是否存在这个变量和值是否正确：</p>
<pre class="line-numbers language-none"><code class="language-none">onShow()&#123;
    const key &#x3D; wx.getStorageSync(&#39;***&#39;);
    if(key &amp;&amp; key &#x3D;&#x3D;&#x3D; &#39;***&#39;) &#123;
        &#x2F;&#x2F; 刷新页面数据
    &#125;
&#125;</code></pre>

<p>这样做能够实现需求，但是有坏处：</p>
<ol>
<li><code>onShow</code>在很多场景都会触发，导致过多无意义的缓存数据读取判断</li>
<li>本地缓存数据过多</li>
<li>管理不方便</li>
</ol>
<p>有事件通信后，我们可以在A页面跳转时<em>注册事件</em>：</p>
<pre class="line-numbers language-none"><code class="language-none">wx.navigateTo(&#123;
    url: &#39;&#x2F;pages&#x2F;B&#x2F;B&#39;,
    events: &#123;
        refreshEvent: () &#x3D;&gt; &#123;
            &#x2F;&#x2F; 刷新数据
        &#125;
    &#125;
&#125;)</code></pre>

<p>在B页面<em>触发事件</em>：</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; 首先获取eventChannel
const chan &#x3D; this.getOpenerEventChannel();
&#x2F;&#x2F; 触发事件
chan.emit(&#39;refreshEvent&#39;);
&#x2F;&#x2F; 如果需要传参数
chan.emit(&#39;refreshEvent&#39;, &#123;key: val&#125;);
wx.navigateBack(&#123;delta: 1&#125;)</code></pre>

<p>也可以将触发事件逻辑放在<code>wx.navigateBack</code>的<code>success</code>回调函数中。这样，就轻松实现回退页面并刷新数据了。最后，需要注意的是：<br><strong>页面间通信仅支持wx.navigateTo跳转的页面中使用，其他几种跳转页面的方式不支持</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/the-communications-of-pages.html" data-id="cm82dxb1l008i0cpjfrxk56dp" data-title="小程序页面间事件通信" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">小程序</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9A%E4%BF%A1/" rel="tag">通信</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A1%B5%E9%9D%A2/" rel="tag">页面</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-the-communications-and-events-between-miniprogram-s-components" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/the-communications-and-events-between-miniprogram-s-components.html" class="article-date">
  <time class="dt-published" datetime="2023-05-25T09:16:48.000Z" itemprop="datePublished">2023-05-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/the-communications-and-events-between-miniprogram-s-components.html">小程序组件间通信与事件实际应用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>小程序从<code>1.6.3</code>版本后开始支持组件化编程，开发可以自定义许多可复用的组件。在页面中使用一个或多个组件后，就存在一个数据传递问题，这其实就是通信。小程序的通信有3种方式：</p>
<ol>
<li>WXML数据绑定：用于父组件向子组件的指定属性设置数据，仅能设置 JSON 兼容数据（自基础库版本 2.0.9 开始，还可以在数据中包含函数）。</li>
<li>事件：用于子组件向父组件传递数据，可以传递任意数据。</li>
<li>如果以上两种方式不足以满足需要，父组件还可以通过 this.selectComponent 方法获取子组件实例对象，这样就可以直接访问组件的任意数据和方法。</li>
</ol>
<p>第一种很简单，这里主要记录第二种的使用。</p>
<p>看下面两张图片，在首页，由多个组件组成，点击更多跳转对应的页面。</p>
<p><img src="/the-communications-and-events-between-miniprogram-s-components/1.png" alt="首页1"><br><img src="/the-communications-and-events-between-miniprogram-s-components/2.png" alt="首页2"></p>
<p>在搜索页面，同样需要用到这些组件</p>
<p><img src="/the-communications-and-events-between-miniprogram-s-components/3.png" alt="搜索页"></p>
<p>可是在做首页的时候，这里的更多已经在组件里定义好了，跳转到新的页面。而搜索这里需求却又不是跳转新页面，应是当前顶部对应的菜单。两个页面在这里就矛盾了，而且从体验上来说，搜索这里肯定不能有页面的切换的。难道要把所有组件重新复制一个出来吗？这里就可以用到事件了。</p>
<p>在搜索页面调用组件时，我们绑定一个自定义事件<code>more</code>，并且传入一个属性<code>isSearch</code>：</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;component-name bind:more&#x3D;&quot;doMore&quot; isSearch&#x3D;&quot;1&quot;&#x2F;&gt;</code></pre>

<p>搜索页面里定义这个<code>doMore</code>方法。组件更多按钮的点击事件内判断，如果是搜索页面这里点击更多，就触发这个事件：</p>
<pre class="line-numbers language-none"><code class="language-none">if(this.data.isSearch &#x3D;&#x3D; 1) &#123;
    this.triggerEvent(&#39;more&#39;);
    return false;
&#125;

&#x2F;&#x2F; 非搜索页面正常跳转...</code></pre>

<p>这样，在搜索页只需要在doMore方法里面切换顶部菜单显示就可以了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lizubin.com/the-communications-and-events-between-miniprogram-s-components.html" data-id="cm82dxb17007d0cpjfsgg45no" data-title="小程序组件间通信与事件实际应用" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BA%8B%E4%BB%B6/" rel="tag">事件</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">小程序</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BB%84%E4%BB%B6/" rel="tag">组件</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9A%E4%BF%A1/" rel="tag">通信</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/the-differences-of-href-between-firefox-and-chrome.html">href=&#39;javascript:&#39;在firefox与chrome中的不同表现</a>
          </li>
        
          <li>
            <a href="/use-multi-stage-to-reduce-size-of-docker-images.html">用Multi-stage builds给你的docker镜像瘦身</a>
          </li>
        
          <li>
            <a href="/ffmpeg-installation-guide.html">ffmpeg安装记录</a>
          </li>
        
          <li>
            <a href="/how-to-generate-excel-s-cell-by-php-s-closure.html">如何使用PHP闭包生成Excel单元格坐标</a>
          </li>
        
          <li>
            <a href="/how-to-use-php-to-generate-a-word-file-by-html.html">使用PHP根据html内容生成word文件</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/2048/" style="font-size: 10px;">2048</a> <a href="/tags/3Sum/" style="font-size: 10px;">3Sum</a> <a href="/tags/4sum/" style="font-size: 10px;">4sum</a> <a href="/tags/Container-With-Most-Water/" style="font-size: 10px;">Container With Most Water</a> <a href="/tags/File/" style="font-size: 10px;">File</a> <a href="/tags/IP/" style="font-size: 10px;">IP</a> <a href="/tags/Integer-to-Roman/" style="font-size: 10px;">Integer to Roman</a> <a href="/tags/SimpleAjaxUploader/" style="font-size: 11.25px;">SimpleAjaxUploader</a> <a href="/tags/Volt/" style="font-size: 10px;">Volt</a> <a href="/tags/add-two-numbers/" style="font-size: 10px;">add two numbers</a> <a href="/tags/ajax/" style="font-size: 12.5px;">ajax</a> <a href="/tags/auth/" style="font-size: 10px;">auth</a> <a href="/tags/bootstrap/" style="font-size: 11.25px;">bootstrap</a> <a href="/tags/canvas/" style="font-size: 11.25px;">canvas</a> <a href="/tags/center/" style="font-size: 10px;">center</a> <a href="/tags/closure/" style="font-size: 10px;">closure</a> <a href="/tags/command/" style="font-size: 10px;">command</a> <a href="/tags/cors/" style="font-size: 10px;">cors</a> <a href="/tags/css/" style="font-size: 11.25px;">css</a> <a href="/tags/curl/" style="font-size: 10px;">curl</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/download/" style="font-size: 10px;">download</a> <a href="/tags/elasitcsearch/" style="font-size: 11.25px;">elasitcsearch</a> <a href="/tags/elasticsearch/" style="font-size: 16.25px;">elasticsearch</a> <a href="/tags/emoji/" style="font-size: 10px;">emoji</a> <a href="/tags/error/" style="font-size: 10px;">error</a> <a href="/tags/es6/" style="font-size: 11.25px;">es6</a> <a href="/tags/export-to-file/" style="font-size: 10px;">export to file</a> <a href="/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/guide/" style="font-size: 10px;">guide</a> <a href="/tags/header/" style="font-size: 10px;">header</a> <a href="/tags/hover/" style="font-size: 10px;">hover</a> <a href="/tags/href/" style="font-size: 10px;">href</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/innerText/" style="font-size: 10px;">innerText</a> <a href="/tags/installation/" style="font-size: 10px;">installation</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a> <a href="/tags/ipv6/" style="font-size: 10px;">ipv6</a> <a href="/tags/javascript/" style="font-size: 17.5px;">javascript</a> <a href="/tags/js/" style="font-size: 11.25px;">js</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/leetcode/" style="font-size: 18.75px;">leetcode</a> <a href="/tags/logstash/" style="font-size: 10px;">logstash</a> <a href="/tags/memory/" style="font-size: 10px;">memory</a> <a href="/tags/minmax/" style="font-size: 10px;">minmax</a> <a href="/tags/modal/" style="font-size: 10px;">modal</a> <a href="/tags/multi-stage/" style="font-size: 10px;">multi-stage</a> <a href="/tags/multi-match/" style="font-size: 10px;">multi_match</a> <a href="/tags/mysql/" style="font-size: 13.75px;">mysql</a> <a href="/tags/nested/" style="font-size: 10px;">nested</a> <a href="/tags/nfs/" style="font-size: 10px;">nfs</a> <a href="/tags/nproc/" style="font-size: 10px;">nproc</a> <a href="/tags/paligdrome/" style="font-size: 10px;">paligdrome</a> <a href="/tags/parse/" style="font-size: 10px;">parse</a> <a href="/tags/phalcon/" style="font-size: 13.75px;">phalcon</a> <a href="/tags/php/" style="font-size: 20px;">php</a> <a href="/tags/phpstorm/" style="font-size: 10px;">phpstorm</a> <a href="/tags/powershell/" style="font-size: 10px;">powershell</a> <a href="/tags/promise/" style="font-size: 10px;">promise</a> <a href="/tags/public-network/" style="font-size: 10px;">public network</a> <a href="/tags/rpc/" style="font-size: 10px;">rpc</a> <a href="/tags/rsync/" style="font-size: 10px;">rsync</a> <a href="/tags/sersync/" style="font-size: 10px;">sersync</a> <a href="/tags/text/" style="font-size: 10px;">text</a> <a href="/tags/textContent/" style="font-size: 10px;">textContent</a> <a href="/tags/toDataURL/" style="font-size: 10px;">toDataURL</a> <a href="/tags/transaction/" style="font-size: 10px;">transaction</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/upload/" style="font-size: 10px;">upload</a> <a href="/tags/vagrant/" style="font-size: 10px;">vagrant</a> <a href="/tags/view/" style="font-size: 10px;">view</a> <a href="/tags/volt/" style="font-size: 10px;">volt</a> <a href="/tags/vue/" style="font-size: 10px;">vue</a> <a href="/tags/webview/" style="font-size: 10px;">webview</a> <a href="/tags/window-opener/" style="font-size: 10px;">window.opener</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/windows-11/" style="font-size: 10px;">windows 11</a> <a href="/tags/word/" style="font-size: 10px;">word</a> <a href="/tags/wsl/" style="font-size: 10px;">wsl</a> <a href="/tags/zephir/" style="font-size: 10px;">zephir</a> <a href="/tags/zui/" style="font-size: 10px;">zui</a> <a href="/tags/%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/" style="font-size: 10px;">上传文件</a> <a href="/tags/%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0/" style="font-size: 10px;">下拉刷新</a> <a href="/tags/%E4%BA%8B%E4%BB%B6/" style="font-size: 10px;">事件</a> <a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 10px;">函数</a> <a href="/tags/%E5%88%86%E7%89%87%E4%B8%8A%E4%BC%A0/" style="font-size: 10px;">分片上传</a> <a href="/tags/%E5%8E%8B%E7%BC%A9%E5%9B%BE%E7%89%87/" style="font-size: 10px;">压缩图片</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 10px;">字符串</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 15px;">小程序</a> <a href="/tags/%E5%BC%BA%E5%88%B6%E5%88%B7%E6%96%B0/" style="font-size: 10px;">强制刷新</a> <a href="/tags/%E6%89%A9%E5%B1%95/" style="font-size: 10px;">扩展</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/" style="font-size: 10px;">数据同步</a> <a href="/tags/%E6%95%B0%E7%BB%84/" style="font-size: 10px;">数组</a> <a href="/tags/%E6%A8%A1%E6%9D%BF/" style="font-size: 10px;">模板</a> <a href="/tags/%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4/" style="font-size: 10px;">磁盘空间</a> <a href="/tags/%E7%BB%84%E4%BB%B6/" style="font-size: 10px;">组件</a> <a href="/tags/%E7%BC%93%E5%AD%98/" style="font-size: 10px;">缓存</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" style="font-size: 10px;">网络请求</a> <a href="/tags/%E8%85%BE%E8%AE%AF%E5%9C%B0%E5%9B%BE/" style="font-size: 10px;">腾讯地图</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85/" style="font-size: 10px;">自动填充</a> <a href="/tags/%E8%A1%A8%E5%8D%95/" style="font-size: 10px;">表单</a> <a href="/tags/%E8%A7%86%E9%A2%91%E6%88%AA%E5%9B%BE/" style="font-size: 10px;">视频截图</a> <a href="/tags/%E9%80%9A%E4%BF%A1/" style="font-size: 11.25px;">通信</a> <a href="/tags/%E9%97%AD%E5%8C%85/" style="font-size: 10px;">闭包</a> <a href="/tags/%E9%A1%B5%E9%9D%A2/" style="font-size: 10px;">页面</a> <a href="/tags/%E9%A2%91%E7%B9%81%E8%B0%83%E7%94%A8/" style="font-size: 10px;">频繁调用</a> <a href="/tags/%E9%BB%98%E8%AE%A4%E5%80%BC/" style="font-size: 11.25px;">默认值</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">十月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">八月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">六月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2015-2025 李祖彬&emsp;&emsp;邮箱：zeno-li#qq.com<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
      <!-- &emsp;&emsp;<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">蜀ICP备19034130号-1</a> -->
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/words" class="mobile-nav-link">杂念</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>


<script src="/js/rough-notation.iife.js"></script>

<script>
    const annotate = RoughNotation.annotate;
    const annotationGroup = RoughNotation.annotationGroup;

    // 高亮
    {
      const ag = []
      $('p code').each((i, e) => {
        ag.push(
          annotate(e, { type: 'box', color: '#F44336', padding: 3 })
        )
      })
      annotationGroup(ag).show()
    }

    // 引用
    {
      const ag = []
      $('blockquote p').each((i, e) => {
        ag.push(
          annotate(e, { type: 'bracket', color: 'red', strokeWidth: 2, padding: [2, 10], brackets: ['left', 'right'] })
        )
      })
      annotationGroup(ag).show()
    }
</script>




  </div>
</body>
</html>